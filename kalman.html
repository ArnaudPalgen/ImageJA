<html><head><title>Kalman Filter</title></head><body bgcolor = "#ffffff"><font color="#224488" face="Helvetica, Arial" size=+1><b>Kalman Filter</b></font><p><blockquote><table cellspacing=5><tr valign=top><td ><b>Author:</b></td><td >Christopher Philip Mauer (cpmauer at northwestern.edu)</td></tr><tr valign=top><td ><b>History:</b></td><td ><u>2003/05/23:</u> First version<br><u>2003/07/25:</u> Fixes a bug that caused the first slice<br> of the input stack to be copied to the last slice of the output stack.<br> <u>2006/11/17:</u> Macro bug fixes by Shannon Stewman (stew at uchicago.edu)<br><u>2009/08/05:</u> Works with all image types; filters in place<br></td></tr><tr valign=top><td ><b>Source:</b></td><td ><A HREF="download/Kalman_Stack_Filter.java">Kalman_Stack_Filter.java</A></td></tr><tr valign=top><td ><b>Installation:</b></td><td >Drag and drop <A href="download/Kalman_Stack_Filter.class">Kalman_Stack_Filter.class</A>onto the "ImageJ" window (v1.43 or later).</td></tr><tr valign=top><td ><b>Description:</b></td><td >This plugin implements a recursive prediction/correction algorithm which is based on the Kalman Filter (commonly used for robotic vision andnavigation) to remove high gain noise from time lapse image streams. These filters remove camera/detector noise while recovering faint image detail.<br><br><TT>Copyright (C) 2003  CHRISTOPHER PHILIP MAUER<br>Permission to use, copy, modify, and distribute this software for any purpose without fee is hereby granted, provided that this entire notice is included in all copies of any software which is or includes a copy or modification of this software and in all copies of the supporting documentation for such software.Any for profit use of this software is expressly forbidden without firstobtaining the explicit consent of the author.<br>THIS SOFTWARE IS BEING PROVIDED "AS IS", WITHOUT ANY EXPRESS OR IMPLIED WARRANTY. IN PARTICULAR, THE AUTHOR DOES NOT MAKE ANY REPRESENTATION OR WARRANTY OF ANY KIND CONCERNING THE MERCHANTABILITY OF THIS SOFTWARE OR ITS FITNESS FOR ANY PARTICULAR PURPOSE</TT>.<br><br>The user can specify:<ul>	<li>Initial noise variance estimate	<li>Filter gain</ul>Wrong guesses for the initial variance will not prevent noise estimation,but merely delay the fitting process.  High filter gain renders the outputless sensitive to momentary fluctuations.<br><br><p>The filter performs the following steps:<ol>   <li>Initialization			<ul>				<li>User input specifies the filter gain: G				<li>User input specifies the noise variance estimate: V     	  <li>Use the first image as the prediction seed: I<SUP>-</SUP><SUB>k</SUB> = I<SUB>k</SUB>				<li>Use the variance estimate as the error seed: E<SUP>-</SUP><SUB>k</SUB> = V			</ul>		<li>Correction                          																														<ul>       	<li>Compute the Kamlan Gain: K<SUB>k</SUB> = E<SUP>-</SUP><SUB>k</SUB>/(E<SUP>-</SUP><SUB>k</SUB> + V)				<li>Update the image prediction with the (M<SUB>k</SUB>) measurement: I<SUB>k</SUB> = G*I<SUP>-</SUP><SUB>k</SUB> + (1.0-G)*M<SUB>k</SUB> + K<SUB>k</SUB>(M<SUB>k</SUB>-I<SUP>-</SUP><SUB>k</SUB>)				<li>Update the variance estimate: E<SUB>k</SUB>=E<SUP>-</SUP><SUB>k</SUB>(1-K<SUB>k</SUB>)			</ul>		    <li>Prediction      <ul>				<li>Predict the next image: I<SUP>-</SUP><SUB>k+1</SUB> = I<SUB>k</SUB> 				<li>Predict the variance:  E<SUP>-</SUP><SUB>k+1</SUB> = E<SUB>k</SUB>       </ul>					<li>Update values			<ul>				<li>E<SUP>-</SUP><SUB>k</SUB>=E<SUP>-</SUP><SUB>k+1</SUB> 				<li>I<SUP>-</SUP><SUB>k</SUB>=I<SUP>-</SUP><SUB>k+1</SUB>			</ul>		<li>Repeat 2,3,4</ol>	       <p>Another version of the filter (<A HREF="download/Kalman_Filter.java">Kalman_Filter.java</A>)operates in constant memory space by loading each image and storingthe data in memory only as long as it is needed for the computation.  The runtimedisplay consists of two data frames containing the raw and filtered image streamswhich are displayed movie-style, and a GUI interface with the ability to adjust thefilter gain and processing/playback rates (on the fly), as well as stop theprocedure and restart.  Repeating the filter will apply the learned prediction andnoise models to the initial data.<br>The user can specify:<ul>	<li>The naming convention for input file selection (series of single images, not stacks)	<li>The naming convention for file saving (basename to be padded with sequence numbers)	<li>The output directory (each filtered image is saved as a tif)	<li>Whether or not to save the data which is produced	<li>Initial noise variance estimate	<li>Filter gain</ul><hr><p><center><IMG SRC="images/GFPraw-vs-Kalman.gif" ALT="images/GFPraw-vs-Kalman.gif"><br><blockquote><p>Movies show time lapse images of MIN6 insulinoma cells expressing a GFP-syncollin fusion protein that localizes to insulin granules (approx 300nm diameter). Images were obtained on a Zeiss LSM510 cofocal microscope using low laser power and high PMT gain. Left panel is the raw data; right panel shows the same data after application of the Kalman_Filter plugin (filter gain=0.80). Note the reduction of shot noise, enhanced detail of dim features, and slight motion artifacts produced by this high gain setting.<br>(images courtesy of the University of Chicago Digital Light Microscopy Facility) </p></blockquote></center><br><p><b>|<a href="index.html">Plugins</a> | <a href="../index.html">Home</a> |</b></body></html>
